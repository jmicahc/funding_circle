(ns funding_circle.core
  (:import clojure.lang.MapEntry java.util.Map clojure.lang.PersistentTreeMap)
  (:require [clojure.data.priority-map :refer [priority-map]]
            [clojure.pprint :refer [print-table]]
            [funding_circle.prime-algorithms :as algs])
  (:gen-class))


(defn infinite-table
  ([f] (infinite-table (range) (range) f))
  ([xs f] (infinite-table xs xs f))
  ([xs ys f] (map (fn [x] (map (fn [y] (f x y)) ys)) xs))
  ([xs ys f m n]
   (let [mat (infinite-table xs ys f)]
     (lazy-seq (drop m (map #(drop n %) mat)))))
  ([xs ys f m n s t]
   (let [mat (infinite-table xs ys f m n)]
     (take s (map #(take t %) mat)))))


(defn print-primes [primes start n]
  (let [table (infinite-table primes primes * start start n n)]
    (println "Multiplication table of prime numbers\n")
    (print "       ")
    (doseq [prime (take n (drop start primes))]
      (print (format "% 7d" prime)))
    (println)
    (doseq [i (range (inc n))]
      (print "_______"))
    (doseq [[row prime] (map list table (take n (drop start primes)))]
      (print "\n" (format "% 4d" prime) "|")
      (doseq [item row]
        (print (format "% 7d" item))))
    (println)))


(defn -main [& args]
  (print-primes algs/wheel2357-primes 0 10))
